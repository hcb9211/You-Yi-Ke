define("register/bindphone",[],function(e,n,s){var a={bindEvent:function(){$("body").delegate(".js-tap","click",function(e){var n=$(this).data("handler");a[n]&&a[n].call(this)})},checkPhone:function(){var e=$("#phone").val();e=e.replace(/(^\s+)|(\s+$)/g,"");var n=/^(((13[0-9]{1})|(15[0-9]{1})|(17[0-9]{1})|(18[0-9]{1}))+\d{8})$/;return!!n.test(e)&&e},checkSmsCode:function(e,n){var s=$("#smsCode").val();s&&(s=s.replace(/(^\s+)|(\s+$)/g,""));var a=new RegExp("^\\d{4}$");if(!s||!a.test(s))return $.Func.pop("请输入正确短信验证码！"),!1;var t={jsonrpc:"2.0",method:"Other.VerifyVerificationCode",id:54321,params:{phone:e,code:s}};$.Func.ajax(t,function(e){var s=e.result;s&&(s.status>1?$.Func.pop(s.statusmsg):$.isFunction(n)&&n())})},getSmsCode:function(){var e=this,n=a.checkPhone();if(!n)return $.Func.pop("请输入有效的手机号码！"),!1;var s={jsonrpc:"2.0",method:"Other.SendVerificationCode",id:54321,params:{phone:n}},t=$(e).attr("disabled");t||$.Func.ajax(s,function(n){var s=n.result;if(s){var a=($(e).attr("disabled"),60);$(e).addClass("disabled").attr("disabled","disabled").html(a+"s后重新获取");var t=setInterval(function(){a--,a>0?$(e).html(a+"s后重新获取"):($(e).removeClass("disabled").removeAttr("disabled").html("重新发送"),clearInterval(t))},1e3)}else $.Func.pop(n.error.message)})},back:function(){history.go(-1)},closeLayer:function(){$("#layer").removeClass("show")},submit:function(){var e,n=a.checkPhone(),s=$.User.entrance;switch(s){case"club":e=$.CONFIG.CLUB;break;case"fund":e=$.CONFIG.INDEX}a.checkSmsCode(n,function(s){$.User.wxapp||$.Func.bindWeixin(n,$.User.unionid,function(){}),$.User.wxgzh?e?location.href=e:$("body").addClass("show-result"):$.Func.bindGZH(n,$.User.openid,function(n){var s=n.result;if(s)switch(s.status){case 1:$("body").addClass("show-result"),e&&setTimeout(function(){location.href=e},2e3);break;case 2:e?location.href=e:$("body").addClass("show-result");break;default:$.Func.pop(s.statusmsg)}else $.Func.pop(n.error.message)})})},init:function(){$.Func.getUserInfo(),a.bindEvent();var e=$.User.entrance;e&&"bind"!=e&&$("#back").removeClass("hide")}};s.exports=a});